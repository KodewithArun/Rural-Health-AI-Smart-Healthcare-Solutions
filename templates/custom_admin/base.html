{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}{{ title }} - Admin Panel{% endblock %}</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#7c3aed",
              secondary: "#6366f1",
            },
          },
        },
      };
    </script>

    <!-- Remix Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Alpine.js -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"
    ></script>

    <style>
      [x-cloak] {
        display: none !important;
      }
      .sidebar-link:hover {
        background: linear-gradient(
          90deg,
          rgba(124, 58, 237, 0.1) 0%,
          rgba(124, 58, 237, 0.05) 100%
        );
      }
      .sidebar-link.active {
        background: linear-gradient(
          90deg,
          rgba(124, 58, 237, 0.2) 0%,
          rgba(124, 58, 237, 0.1) 100%
        );
        border-left: 4px solid #7c3aed;
      }
    </style>

    {% block extra_head %}{% endblock %}
  </head>
  <body
    class="bg-gray-50"
    x-data="{ sidebarOpen: true, mobileMenuOpen: false }"
  >
    <!-- Mobile Menu Button -->
    <div class="lg:hidden fixed top-4 left-4 z-50">
      <button
        @click="mobileMenuOpen = !mobileMenuOpen"
        class="p-2 rounded-lg bg-white shadow-lg text-gray-700 hover:bg-gray-100 transition"
      >
        <i class="ri-menu-line text-2xl"></i>
      </button>
    </div>

    <!-- Sidebar -->
    <aside
      :class="mobileMenuOpen ? 'translate-x-0' : '-translate-x-full'"
      class="fixed top-0 left-0 h-screen bg-white shadow-xl z-40 transition-transform duration-300 lg:translate-x-0"
      :style="sidebarOpen ? 'width: 16rem' : 'width: 5rem'"
    >
      <!-- Logo -->
      <div
        class="flex items-center justify-between p-4 border-b border-gray-200"
      >
        <div class="flex items-center space-x-3" x-show="sidebarOpen" x-cloak>
          <div
            class="w-10 h-10 bg-gradient-to-br from-purple-600 to-indigo-600 rounded-lg flex items-center justify-center"
          >
            <i class="ri-hospital-line text-white text-xl"></i>
          </div>
          <div>
            <h1 class="text-lg font-bold text-gray-800">Rural Health</h1>
            <p class="text-xs text-gray-500">Admin Panel</p>
          </div>
        </div>
        <button
          @click="sidebarOpen = !sidebarOpen"
          class="hidden lg:block p-2 rounded-lg hover:bg-gray-100 transition"
        >
          <i
            :class="sidebarOpen ? 'ri-menu-fold-line' : 'ri-menu-unfold-line'"
            class="text-xl text-gray-600"
          ></i>
        </button>
      </div>

      <!-- Navigation -->
      <nav class="p-4 space-y-2 overflow-y-auto h-[calc(100vh-80px)]">
        <a
          href="{% url 'custom_admin:dashboard' %}"
          class="sidebar-link flex items-center space-x-3 p-3 rounded-lg transition {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
        >
          <i
            class="ri-dashboard-line text-xl {% if request.resolver_match.url_name == 'dashboard' %}text-purple-600{% else %}text-gray-600{% endif %}"
          ></i>
          <span
            x-show="sidebarOpen"
            x-cloak
            class="font-medium {% if request.resolver_match.url_name == 'dashboard' %}text-purple-600{% else %}text-gray-700{% endif %}"
            >Dashboard</span
          >
        </a>

        <a
          href="{% url 'custom_admin:user_list' %}"
          class="sidebar-link flex items-center space-x-3 p-3 rounded-lg transition {% if 'user' in request.resolver_match.url_name %}active{% endif %}"
        >
          <i
            class="ri-user-line text-xl {% if 'user' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-600{% endif %}"
          ></i>
          <span
            x-show="sidebarOpen"
            x-cloak
            class="font-medium {% if 'user' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-700{% endif %}"
            >Users</span
          >
        </a>

        <a
          href="{% url 'custom_admin:appointment_list' %}"
          class="sidebar-link flex items-center space-x-3 p-3 rounded-lg transition {% if 'appointment' in request.resolver_match.url_name %}active{% endif %}"
        >
          <i
            class="ri-calendar-check-line text-xl {% if 'appointment' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-600{% endif %}"
          ></i>
          <span
            x-show="sidebarOpen"
            x-cloak
            class="font-medium {% if 'appointment' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-700{% endif %}"
            >Appointments</span
          >
        </a>

        <a
          href="{% url 'custom_admin:enquiry_list' %}"
          class="sidebar-link flex items-center space-x-3 p-3 rounded-lg transition {% if 'enquiry' in request.resolver_match.url_name %}active{% endif %}"
        >
          <i
            class="ri-mail-line text-xl {% if 'enquiry' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-600{% endif %}"
          ></i>
          <span
            x-show="sidebarOpen"
            x-cloak
            class="font-medium {% if 'enquiry' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-700{% endif %}"
            >Enquiries</span
          >
        </a>

        <a
          href="{% url 'custom_admin:document_list' %}"
          class="sidebar-link flex items-center space-x-3 p-3 rounded-lg transition {% if 'document' in request.resolver_match.url_name %}active{% endif %}"
        >
          <i
            class="ri-file-text-line text-xl {% if 'document' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-600{% endif %}"
          ></i>
          <span
            x-show="sidebarOpen"
            x-cloak
            class="font-medium {% if 'document' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-700{% endif %}"
            >Documents</span
          >
        </a>

        <a
          href="{% url 'custom_admin:awareness_list' %}"
          class="sidebar-link flex items-center space-x-3 p-3 rounded-lg transition {% if 'awareness' in request.resolver_match.url_name %}active{% endif %}"
        >
          <i
            class="ri-lightbulb-line text-xl {% if 'awareness' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-600{% endif %}"
          ></i>
          <span
            x-show="sidebarOpen"
            x-cloak
            class="font-medium {% if 'awareness' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-700{% endif %}"
            >Awareness</span
          >
        </a>

        <a
          href="{% url 'custom_admin:chat_history_list' %}"
          class="sidebar-link flex items-center space-x-3 p-3 rounded-lg transition {% if 'chat' in request.resolver_match.url_name %}active{% endif %}"
        >
          <i
            class="ri-chat-3-line text-xl {% if 'chat' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-600{% endif %}"
          ></i>
          <span
            x-show="sidebarOpen"
            x-cloak
            class="font-medium {% if 'chat' in request.resolver_match.url_name %}text-purple-600{% else %}text-gray-700{% endif %}"
            >Chats</span
          >
        </a>

        <div class="pt-4 mt-4 border-t border-gray-200">
          <a
            href="{% url 'custom_admin:profile' %}"
            class="sidebar-link flex items-center space-x-3 p-3 rounded-lg transition {% if request.resolver_match.url_name == 'profile' %}active{% endif %}"
          >
            <i
              class="ri-user-settings-line text-xl {% if request.resolver_match.url_name == 'profile' %}text-purple-600{% else %}text-gray-600{% endif %}"
            ></i>
            <span
              x-show="sidebarOpen"
              x-cloak
              class="font-medium {% if request.resolver_match.url_name == 'profile' %}text-purple-600{% else %}text-gray-700{% endif %}"
              >My Profile</span
            >
          </a>

          <a
            href="{% url 'home' %}"
            class="sidebar-link flex items-center space-x-3 p-3 rounded-lg transition text-gray-600 hover:text-purple-600"
          >
            <i class="ri-home-line text-xl"></i>
            <span x-show="sidebarOpen" x-cloak class="font-medium"
              >Back to Site</span
            >
          </a>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <div
      :class="sidebarOpen ? 'lg:ml-64' : 'lg:ml-20'"
      class="transition-all duration-300"
    >
      <!-- Top Header -->
      <header
        class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-30"
      >
        <div class="flex items-center justify-between px-6 py-4">
          <div>
            <h2 class="text-2xl font-bold text-gray-800">{{ title }}</h2>
            {% block breadcrumbs %}{% endblock %}
          </div>

          <div class="flex items-center space-x-4">
            <!-- User Menu -->
            <div
              class="flex items-center space-x-3 px-4 py-2 bg-gray-50 rounded-lg"
              x-data="{ userMenu: false }"
            >
              <div
                class="w-10 h-10 bg-gradient-to-br from-purple-600 to-indigo-600 rounded-full flex items-center justify-center"
              >
                <!-- add icon here -->
                <i class="ri-shield-user-line text-4xl text-white"></i>
              </div>
              <div class="hidden md:block">
                <p class="text-sm font-semibold text-gray-800">
                  {{ request.user.get_full_name }}
                </p>
                <p class="text-xs text-gray-500">
                  {{ request.user.role|title }}
                </p>
              </div>
              <div class="relative">
                <button
                  @click="userMenu = !userMenu"
                  class="p-2 hover:bg-gray-100 rounded-lg transition"
                >
                  <i class="ri-arrow-down-s-line text-gray-600"></i>
                </button>
                <div
                  x-show="userMenu"
                  @click.away="userMenu = false"
                  x-cloak
                  class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 py-2"
                >
                  <a
                    href="{% url 'accounts:profile' %}"
                    class="flex items-center space-x-2 px-4 py-2 hover:bg-gray-50 transition"
                  >
                    <i class="ri-user-line text-gray-600"></i>
                    <span class="text-sm text-gray-700">My Profile</span>
                  </a>
                  <hr class="my-2" />
                  <a
                    href="{% url 'accounts:logout' %}"
                    class="flex items-center space-x-2 px-4 py-2 hover:bg-red-50 transition text-red-600"
                  >
                    <i class="ri-logout-box-line"></i>
                    <span class="text-sm">Logout</span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Messages -->
      {% if messages %}
      <div class="px-6 py-4" x-data="{ show: true }">
        {% for message in messages %}
        <div
          x-show="show"
          x-transition
          class="flex items-center justify-between p-4 mb-3 rounded-lg {% if message.tags == 'success' %}bg-green-50 border border-green-200{% elif message.tags == 'error' %}bg-red-50 border border-red-200{% elif message.tags == 'warning' %}bg-yellow-50 border border-yellow-200{% else %}bg-blue-50 border border-blue-200{% endif %}"
        >
          <div class="flex items-center space-x-3">
            <i
              class="{% if message.tags == 'success' %}ri-checkbox-circle-line text-green-600{% elif message.tags == 'error' %}ri-error-warning-line text-red-600{% elif message.tags == 'warning' %}ri-alert-line text-yellow-600{% else %}ri-information-line text-blue-600{% endif %} text-xl"
            ></i>
            <p
              class="{% if message.tags == 'success' %}text-green-800{% elif message.tags == 'error' %}text-red-800{% elif message.tags == 'warning' %}text-yellow-800{% else %}text-blue-800{% endif %} font-medium"
            >
              {{ message }}
            </p>
          </div>
          <button
            @click="show = false"
            class="{% if message.tags == 'success' %}text-green-600 hover:text-green-800{% elif message.tags == 'error' %}text-red-600 hover:text-red-800{% elif message.tags == 'warning' %}text-yellow-600 hover:text-yellow-800{% else %}text-blue-600 hover:text-blue-800{% endif %}"
          >
            <i class="ri-close-line text-xl"></i>
          </button>
        </div>
        {% endfor %}
      </div>
      {% endif %}

      <!-- Page Content -->
      <main class="px-6 py-6">{% block content %}{% endblock %}</main>

      <!-- Footer -->
      <footer class="px-6 py-4 border-t border-gray-200 bg-white mt-8">
        <div class="flex items-center justify-between text-sm text-gray-600">
          <p>&copy; 2024 Rural Health AI. All rights reserved.</p>
          <p>Admin Panel v1.0</p>
        </div>
      </footer>
    </div>

    <!-- Close mobile menu when clicking backdrop -->
    <div
      x-show="mobileMenuOpen"
      @click="mobileMenuOpen = false"
      x-cloak
      class="fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden"
    ></div>

    {% block extra_scripts %}{% endblock %}
  </body>
</html>
