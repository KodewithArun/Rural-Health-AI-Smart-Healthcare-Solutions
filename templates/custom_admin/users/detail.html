{% extends 'custom_admin/base.html' %} {% block breadcrumbs %}
<nav class="flex text-sm text-gray-600 mt-1">
  <a href="{% url 'custom_admin:dashboard' %}" class="hover:text-purple-600"
    >Dashboard</a
  >
  <span class="mx-2">/</span>
  <a href="{% url 'custom_admin:user_list' %}" class="hover:text-purple-600"
    >Users</a
  >
  <span class="mx-2">/</span>
  <span class="text-gray-800">{{ user_obj.username }}</span>
</nav>
{% endblock %} {% block content %}

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
  <!-- User Profile Card -->
  <div class="lg:col-span-1">
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <!-- Avatar -->
      <div class="flex flex-col items-center">
        <div
          class="w-24 h-24 bg-gradient-to-br from-purple-600 to-indigo-600 rounded-full flex items-center justify-center mb-4"
        >
          <span class="text-white font-bold text-3xl"
            >{{ user_obj.first_name.0 }}{{ user_obj.last_name.0 }}</span
          >
        </div>
        <h3 class="text-xl font-bold text-gray-800">
          {{ user_obj.get_full_name }}
        </h3>
        <p class="text-sm text-gray-500 mt-1">@{{ user_obj.username }}</p>

        <!-- Role Badge -->
        <span
          class="mt-3 px-4 py-1.5 text-sm font-medium rounded-full {% if user_obj.role == 'admin' %}bg-red-100 text-red-700 {% elif user_obj.role == 'health_worker' %}bg-blue-100 text-blue-700 {% else %}bg-green-100 text-green-700{% endif %}"
        >
          {{ user_obj.role|title }}
        </span>

        <!-- Status Badge -->
        <div class="mt-3">
          {% if user_obj.is_active %}
          <span class="flex items-center space-x-1 text-green-600">
            <i class="ri-checkbox-circle-fill"></i>
            <span class="text-sm font-medium">Active</span>
          </span>
          {% else %}
          <span class="flex items-center space-x-1 text-red-600">
            <i class="ri-close-circle-fill"></i>
            <span class="text-sm font-medium">Inactive</span>
          </span>
          {% endif %}
        </div>
      </div>

      <!-- Contact Information -->
      <div class="mt-6 pt-6 border-t border-gray-200 space-y-3">
        <div class="flex items-start space-x-3">
          <i class="ri-mail-line text-purple-600 text-xl mt-0.5"></i>
          <div class="flex-1 min-w-0">
            <p class="text-xs text-gray-500">Email</p>
            <p class="text-sm text-gray-800 break-all">{{ user_obj.email }}</p>
          </div>
        </div>
        {% if user_obj.phone_number %}
        <div class="flex items-start space-x-3">
          <i class="ri-phone-line text-purple-600 text-xl mt-0.5"></i>
          <div class="flex-1 min-w-0">
            <p class="text-xs text-gray-500">Phone</p>
            <p class="text-sm text-gray-800">{{ user_obj.phone_number }}</p>
          </div>
        </div>
        {% endif %}
        <div class="flex items-start space-x-3">
          <i class="ri-calendar-line text-purple-600 text-xl mt-0.5"></i>
          <div class="flex-1 min-w-0">
            <p class="text-xs text-gray-500">Joined</p>
            <p class="text-sm text-gray-800">
              {{ user_obj.date_joined|date:"F d, Y" }}
            </p>
            <p class="text-xs text-gray-500">
              {{ user_obj.date_joined|date:"g:i A" }}
            </p>
          </div>
        </div>
        <div class="flex items-start space-x-3">
          <i class="ri-time-line text-purple-600 text-xl mt-0.5"></i>
          <div class="flex-1 min-w-0">
            <p class="text-xs text-gray-500">Last Login</p>
            <p class="text-sm text-gray-800">
              {{ user_obj.last_login|date:"F d, Y" }}
            </p>
            <p class="text-xs text-gray-500">
              {{ user_obj.last_login|date:"g:i A" }}
            </p>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="mt-6 pt-6 border-t border-gray-200 space-y-2">
        {% if user_obj.role == 'health_worker' or user_obj.role == 'villager' %}
        <a
          href="{% url 'custom_admin:user_toggle_status' user_obj.id %}"
          class="w-full flex items-center justify-center space-x-2 px-4 py-2 {% if user_obj.is_active %} bg-orange-600 hover:bg-orange-700 {% else %} bg-green-600 hover:bg-green-700 {% endif %} text-white rounded-lg transition font-medium"
        >
          <i
            class="{% if user_obj.is_active %} ri-user-unfollow-line {% else %} ri-user-follow-line {% endif %}"
          ></i>
          <span>
            {% if user_obj.is_active %} Deactivate Account {% else %} Activate
            Account {% endif %}
          </span>
        </a>
        {% endif %}

        <a
          href="{% url 'custom_admin:user_delete' user_obj.id %}"
          class="w-full flex items-center justify-center space-x-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition font-medium"
        >
          <i class="ri-delete-bin-line"></i>
          <span>Delete User</span>
        </a>
      </div>
    </div>
  </div>

  <!-- User Statistics and Details -->
  <div class="lg:col-span-2 space-y-6">
    <!-- Statistics Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-600 font-medium">Appointments</p>
            <p class="text-3xl font-bold text-gray-800 mt-2">
              {{ user_appointments }}
            </p>
          </div>
          <div
            class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center"
          >
            <i class="ri-calendar-check-line text-2xl text-purple-600"></i>
          </div>
        </div>
      </div>

      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-600 font-medium">Chat Sessions</p>
            <p class="text-3xl font-bold text-gray-800 mt-2">
              {{ user_chats }}
            </p>
          </div>
          <div
            class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center"
          >
            <i class="ri-chat-3-line text-2xl text-green-600"></i>
          </div>
        </div>
      </div>

      {% if user_obj.role == 'health_worker' %}
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-600 font-medium">Assigned</p>
            <p class="text-3xl font-bold text-gray-800 mt-2">
              {{ assigned_appointments }}
            </p>
          </div>
          <div
            class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center"
          >
            <i class="ri-user-heart-line text-2xl text-blue-600"></i>
          </div>
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Health Worker Profile (if applicable) -->
    {% if user_obj.role == 'health_worker' and health_profile %}
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
        <i class="ri-stethoscope-line text-purple-600 mr-2"></i>
        Health Worker Profile
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="p-4 bg-gray-50 rounded-lg">
          <p class="text-xs text-gray-500 mb-1">Specialization</p>
          <p class="text-sm font-semibold text-gray-800">
            {{ health_profile.specialization }}
          </p>
        </div>
        <div class="p-4 bg-gray-50 rounded-lg">
          <p class="text-xs text-gray-500 mb-1">Experience</p>
          <p class="text-sm font-semibold text-gray-800">
            {{ health_profile.experience_years }} years
          </p>
        </div>
        {% if health_profile.qualification %}
        <div class="p-4 bg-gray-50 rounded-lg md:col-span-2">
          <p class="text-xs text-gray-500 mb-1">Qualification</p>
          <p class="text-sm font-semibold text-gray-800">
            {{ health_profile.qualification }}
          </p>
        </div>
        {% endif %}
        <div class="p-4 bg-gray-50 rounded-lg">
          <p class="text-xs text-gray-500 mb-1">Availability</p>
          <p
            class="text-sm font-semibold {% if health_profile.availability %}text-green-600{% else %}text-red-600{% endif %}"
          >
            {% if health_profile.availability %}
            <i class="ri-checkbox-circle-fill mr-1"></i>Available {% else %}
            <i class="ri-close-circle-fill mr-1"></i>Not Available {% endif %}
          </p>
        </div>
      </div>
    </div>
    {% endif %}

    <!-- Account Details -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
        <i class="ri-information-line text-purple-600 mr-2"></i>
        Account Details
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="p-4 bg-gray-50 rounded-lg">
          <p class="text-xs text-gray-500 mb-1">First Name</p>
          <p class="text-sm font-semibold text-gray-800">
            {{ user_obj.first_name }}
          </p>
        </div>
        <div class="p-4 bg-gray-50 rounded-lg">
          <p class="text-xs text-gray-500 mb-1">Last Name</p>
          <p class="text-sm font-semibold text-gray-800">
            {{ user_obj.last_name }}
          </p>
        </div>
        <div class="p-4 bg-gray-50 rounded-lg">
          <p class="text-xs text-gray-500 mb-1">Username</p>
          <p class="text-sm font-semibold text-gray-800">
            {{ user_obj.username }}
          </p>
        </div>
        <div class="p-4 bg-gray-50 rounded-lg">
          <p class="text-xs text-gray-500 mb-1">Email Address</p>
          <p class="text-sm font-semibold text-gray-800 break-all">
            {{ user_obj.email }}
          </p>
        </div>
        {% if user_obj.phone_number %}
        <div class="p-4 bg-gray-50 rounded-lg">
          <p class="text-xs text-gray-500 mb-1">Phone Number</p>
          <p class="text-sm font-semibold text-gray-800">
            {{ user_obj.phone_number }}
          </p>
        </div>
        {% endif %}
        <div class="p-4 bg-gray-50 rounded-lg">
          <p class="text-xs text-gray-500 mb-1">Account Type</p>
          <p class="text-sm font-semibold text-gray-800">
            {{ user_obj.role|title }}
          </p>
        </div>
      </div>
    </div>

    <!-- Permissions -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
        <i class="ri-shield-check-line text-purple-600 mr-2"></i>
        Permissions & Access
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <div
          class="flex items-center justify-between p-3 bg-gray-50 rounded-lg"
        >
          <span class="text-sm text-gray-700">Account Active</span>
          {% if user_obj.is_active %}
          <i class="ri-checkbox-circle-fill text-green-600 text-xl"></i>
          {% else %}
          <i class="ri-close-circle-fill text-red-600 text-xl"></i>
          {% endif %}
        </div>
        <div
          class="flex items-center justify-between p-3 bg-gray-50 rounded-lg"
        >
          <span class="text-sm text-gray-700">Staff Access</span>
          {% if user_obj.is_staff %}
          <i class="ri-checkbox-circle-fill text-green-600 text-xl"></i>
          {% else %}
          <i class="ri-close-circle-fill text-red-600 text-xl"></i>
          {% endif %}
        </div>
        <div
          class="flex items-center justify-between p-3 bg-gray-50 rounded-lg"
        >
          <span class="text-sm text-gray-700">Admin Access</span>
          {% if user_obj.is_admin %}
          <i class="ri-checkbox-circle-fill text-green-600 text-xl"></i>
          {% else %}
          <i class="ri-close-circle-fill text-red-600 text-xl"></i>
          {% endif %}
        </div>
        <div
          class="flex items-center justify-between p-3 bg-gray-50 rounded-lg"
        >
          <span class="text-sm text-gray-700">Superadmin</span>
          {% if user_obj.is_superadmin %}
          <i class="ri-checkbox-circle-fill text-green-600 text-xl"></i>
          {% else %}
          <i class="ri-close-circle-fill text-red-600 text-xl"></i>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
